[Unit]
Description=Genesis Agent NATS Server
After=network.target genesis-agent-secrets.service
Requires=genesis-agent-secrets.service

[Service]
Type=simple
User=genagent
Group=genagent

# Runtime secrets & config (RAM)
Environment=GENESIS_AGENT_SECRETS_DIR=/run/genesis_agent/secrets

# Runtime libraries
Environment=LD_LIBRARY_PATH=/opt/genesis_agent/python310/lib:/opt/genesis_agent/venv/lib:/usr/local/lib
Environment=PATH=/opt/genesis_agent/python310/bin:/opt/genesis_agent/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

ExecStart=/bin/bash -c "/usr/local/bin/nats-server --config /run/genesis_agent/nats-server.conf 2>&1 | tee -a /var/log/genesis_agent/nats.log"

Restart=always
RestartSec=10

StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
